<!doctype html>
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>title</title>
</head>
<body>
<div id="xxfaxy" style="position:relative;width:540px;height:960px;margin:0px auto;border:1px solid red;"></div>
<script type="text/javascript" language="javascript" charset="utf-8">
function touch(id,cb_start,cb_move,cb_end,minimum){
var self=this;
if(typeof id=="object"){self.element=id;}else if(typeof id=="string"){self.element=document.getElementById(id);}
var x1=x2=y1=y2=0;
var dx=dy=0;
var threshold=(minimum!=null && minimum!="undefined")?minimum:5;
var direction="";
var support=("ontouchstart" in window);
var start=support?"touchstart":"mousedown";
var move=support?"touchmove":"mousemove";
var end=support?"touchend":"mouseup";
if(window.ActiveXObject){
self.element.attachEvent("on"+start,f_start);
self.element.attachEvent("on"+move,f_move);
self.element.attachEvent("on"+end,f_end);
}
else{
self.element.addEventListener(start,f_start,false);
self.element.addEventListener(move,f_move,false);
self.element.addEventListener(end,f_end,false);
}
function f_start(event){
event=event||window.event;
x1=get_xy(event,"pageX")||get_xy(event,"clientX");
y1=get_xy(event,"pageY")||get_xy(event,"clientY");
if(cb_start!=null && cb_start!="undefined"){cb_start.call(self,make_object());}
}
function f_move(event){
event=event||window.event;
x2=get_xy(event,"pageX")||get_xy(event,"clientX");
y2=get_xy(event,"pageY")||get_xy(event,"clientY");
direction=get_direction();
if(cb_move!=null && cb_move!="undefined"){cb_move.call(self,make_object());}
}
function f_end(event){
event=event||window.event;
x2=get_xy(event,"pageX")||get_xy(event,"clientX");
y2=get_xy(event,"pageY")||get_xy(event,"clientY");
direction=get_direction();
if(cb_end!=null && cb_end!="undefined"){cb_end.call(self,make_object());}
}
function get_xy(event,xy){
return support?event.changedTouches[0][xy]:event[xy];
}
function get_direction(){
var result="";
dx=x2-x1;
dy=y2-y1;
dxx=Math.abs(dx);
dyy=Math.abs(dy);
if(dxx>=dyy && dxx>=threshold && dx<0){result="left";}
if(dxx>=dyy && dxx>=threshold && dx>0){result="right";}
if(dxx<=dyy && dyy>=threshold && dy<0){result="up";}
if(dxx<=dyy && dyy>=threshold && dy>0){result="down";}
return result;
}
function make_object(){
var result=new Object();
result.x1=x1;
result.y1=y1;
result.x2=x2;
result.y2=y2;
result.dx=dx;
result.dy=dy;
result.direction=direction;
result.threshold=threshold;
result.element=self.element;
return result;
}
}
touch("xxfaxy",null,null,function(object){object.element.innerHTML=object.direction;},5);
</script>
</body>
</html>